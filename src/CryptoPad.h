#pragma once

const uint8_t CryptoPadHardcoded[] =
        {
            74, 79, 99, 121, 198, 173, 153, 27, 97, 116, 83, 78, 228, 37, 79, 85, 118, 246, 13, 66, 85, 208,
            43, 68, 96, 244, 56, 230, 19, 105, 84, 211, 174, 21, 222, 42, 99, 104, 71, 65, 193, 167, 189, 2,
            215, 17, 203, 42, 194, 154, 130, 49, 227, 187, 25, 67, 108, 91, 219, 6, 223, 128, 43, 119, 219,
            138, 3, 90, 216, 57, 106, 98, 250, 34, 72, 111, 241, 155, 177, 137, 133, 15, 249, 169, 176, 138,
            137, 186, 8, 222, 43, 217, 47, 211, 135, 186, 176, 132, 181, 128, 141, 9, 254, 60, 80, 67, 67,
            236, 169, 172, 57, 97, 233, 148, 9, 90, 111, 108, 252, 47, 222, 49, 102, 230, 160, 15, 208, 136,
            178, 33, 253, 36, 221, 36, 107, 205, 48, 235, 131, 148, 28, 125, 93, 100, 237, 155, 49, 68, 84,
            239, 131, 128, 16, 102, 227, 48, 195, 35, 205, 14, 216, 6, 115, 250, 62, 250, 142, 178, 142, 30,
            218, 145, 191, 27, 251, 15, 250, 41, 120, 216, 52, 111, 220, 41, 240, 137, 180, 146, 24, 95, 204,
            156, 13, 227, 164, 157, 4, 197, 144, 35, 73, 86, 81, 194, 46, 118, 105, 233, 34, 206, 33, 206, 22,
            99, 208, 161, 30, 219, 180, 58, 68, 108, 121, 122, 242, 12, 234, 190, 60, 211, 178, 54, 215, 1,
            115, 68, 67, 66, 227, 132, 130, 61, 255, 37, 87, 232, 147, 63, 77, 240, 131, 44, 193, 134, 164,
            133, 161, 0, 253, 189, 158, 11, 207, 57, 228, 132, 138, 169, 41, 107, 229, 168, 12, 116, 237,
            157, 144, 174, 28, 253, 1, 102, 75, 240, 165, 178, 30, 126, 121, 78, 203, 26, 200, 32, 246, 6,
            255, 51, 194, 187, 183, 50, 82, 193, 17, 243, 30, 232, 2, 91, 251, 178, 160, 141, 0, 126, 239,
            177, 154, 41, 224, 169, 50, 117, 201, 19, 239, 54, 194, 134, 135, 140, 168, 37, 111, 78, 213, 10,
            207, 185, 165, 38, 121, 245, 185, 1, 233, 4, 210, 54, 118, 210, 128, 49, 73, 254, 1, 98, 196, 0,
            115, 234, 13, 253, 52, 225, 15, 216, 31, 101, 100, 204, 157, 38, 90, 67, 216, 51, 226, 189, 56,
            192, 48, 118, 226, 23, 201, 131, 177, 191, 16, 236, 154, 188, 25, 233, 132, 3, 93, 83, 74, 108,
            234, 146, 24, 251, 136, 184, 162, 150, 165, 169, 22, 74, 192, 20, 229, 2, 70, 247, 129, 28, 241,
            175, 52, 206, 0, 195, 143, 164, 31, 214, 34, 229, 182, 18, 196, 161, 138, 173, 171, 59, 114, 218,
            25, 216, 34, 69, 221, 167, 35, 73, 254, 2, 86, 104, 234, 38, 69, 194, 182, 142, 176, 15, 234,
            182, 40, 96, 245, 159, 147, 178, 136, 159, 167, 51, 203, 153, 47, 222, 156, 59, 230, 59, 111,
            241, 133, 172, 191, 33, 90, 201, 46, 241, 146, 40, 90, 204, 43, 231, 4, 110, 202, 137, 150, 63,
            96, 235, 145, 173, 56, 64, 197, 62, 116, 228, 58, 231, 41, 120, 238, 144, 20, 94, 194, 191, 169,
            156, 57, 232, 48, 211, 56, 118, 74, 89, 207, 24, 244, 18, 87, 94, 207, 43, 204, 41, 95, 245, 19,
            246, 51, 70, 201, 8, 102, 78, 82, 232, 9, 242, 183, 155, 36, 65, 85, 248, 140, 25, 235, 63, 73,
            122, 88, 233, 191, 59, 231, 191, 186, 137, 21, 205, 12, 252, 131, 29, 108, 254, 175, 167, 159,
            31, 96, 126, 200, 168, 141, 21, 82, 111, 76, 99, 224, 171, 33, 196, 136, 145, 51, 69, 208, 182,
            182, 131, 147, 158, 50, 228, 3, 64, 85, 213, 58, 240, 16, 205, 21, 238, 134, 24, 214, 159, 139,
            2, 255, 143, 28, 119, 74, 227, 24, 208, 63, 209, 51, 127, 112, 87, 192, 23, 212, 23, 246, 165,
            139, 60, 216, 163, 151, 25, 112, 219, 173, 172, 53, 245, 45, 97, 234, 12, 220, 162, 55, 78, 230,
            29, 193, 42, 246, 21, 246, 172, 25, 201, 3, 221, 36, 213, 140, 58, 249, 4, 76, 105, 85, 242, 189,
            187, 148, 190, 185, 136, 36, 104, 243, 40, 98, 207, 32, 219, 136, 17, 114, 235, 191, 130, 162,
            173, 169, 2, 74, 247, 182, 187, 147, 5, 95, 219, 59, 197, 163, 179, 6, 116, 206, 191, 7, 69, 201,
            44, 113, 210, 48, 207, 138, 191, 1, 192, 161, 48, 94, 115, 203, 37, 116, 202, 188, 7, 249, 151,
            183, 4, 124, 198, 173, 132, 184, 44, 199, 135, 135, 174, 48, 120, 78, 251, 60, 247, 27, 245, 50,
            211, 133, 53, 216, 38, 198, 157, 178, 185, 0, 99, 230, 51, 114, 118, 207, 190, 163, 2, 65, 102,
            192, 18, 208, 8, 84, 97, 226, 161, 28, 238, 190, 23, 84, 196, 20, 97, 203, 35, 223, 172, 4, 242,
            168, 57, 197, 169, 177, 45, 112, 214, 15, 243, 149, 37, 75, 101, 252, 21, 109, 244, 23, 239, 21,
            76, 222, 176, 151, 146, 9, 198, 158, 45, 247, 3, 247, 11, 66, 200, 138, 13, 120, 106, 214, 135,
            189, 46, 226, 45, 98, 199, 184, 135, 51, 108, 206, 178, 183, 173, 33, 211, 28, 228, 142, 14, 109,
            100, 244, 44, 229, 53, 111, 65, 249, 159, 165, 184, 33, 211, 48, 232, 3, 241, 49, 105, 96, 94, 75,
            101, 124, 194, 150, 23, 248, 181, 182, 135, 134, 60, 209, 59, 124, 101, 119, 80, 197, 162, 158,
            12, 253, 15, 100, 251, 8, 77, 254, 185, 15, 206, 153, 152, 38, 104, 80, 222, 151, 5, 227, 5, 95,
            226, 151, 144, 40, 207, 34, 77, 230, 8, 202, 10, 96, 123, 235, 57, 89, 68, 71, 75, 86, 241, 174,
            0, 69, 101, 97, 92, 109, 88, 219, 180, 189, 191, 56, 199, 56, 88, 222, 16, 97, 113, 122, 239, 28,
            67, 86, 204, 49, 217, 16, 216, 133, 23, 193, 31, 73, 116, 207, 154, 188, 16, 81, 222, 157, 5, 69,
            245, 129, 155, 163, 185, 162, 58
        };

void CryptoTransformBlock(uint16_t salt, uint8_t *dataBlock, uint16_t blockSize)
{
    uint16_t saltIndex = salt % sizeof(CryptoPadHardcoded);

    for (uint16_t n = 0; n < blockSize; n++)
    {
        uint8_t padValue = CryptoPadHardcoded[saltIndex];
        dataBlock[n] ^= padValue;
        saltIndex++;
        if (saltIndex >= sizeof(CryptoPadHardcoded))
        {
            saltIndex = 0;
        }
    }
}
